<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Result Preview</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    background: #f4f6f8;
    font-size: 13px;
  }

  .result-card {
    background: #fff;
    padding: 20px 25px;   /* üîª reduced */
    border: 1px solid #000;
    max-width: 900px;     /* üîª prevents edge-to-edge */
    margin: auto;
  }

  .school-name {
    font-weight: 700;
    font-size: 18px;
  }

  .school-sub {
    font-size: 12px;
    line-height: 1.3;
  }

  .report-title {
    font-weight: 700;
    font-size: 14px;
    color: #0d6efd; /* üîµ ONLY colored text */
    margin-top: 6px;
  }

  table {
    margin-bottom: 8px;
  }

  table th,
  table td {
    padding: 4px 6px; /* üîª compact rows */
    font-size: 12px;
  }

  .section-title {
    font-weight: 700;
    font-size: 13px;
    margin: 10px 0 5px;
    border-bottom: 1px solid #000;
  }
  /* WATERMARK */
.result-card {
  position: relative;
  overflow: hidden;
}

.result-card::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url('/assets/school-logo.png') center center no-repeat;
  background-size: 350px;
  opacity: 0.05; /* faint */
  z-index: 0;
}

/* Keep content above watermark */
.result-card > * {
  position: relative;
  z-index: 1;
}
@media print {
  body {
    margin: 0;
    background: #fff;
  }

  .container {
    max-width: 800px;
    margin: auto;
  }

  .result-card {
    padding: 25px;
    border: none;
  }

  table {
    font-size: 12px;
  }
}

</style>

</head>

<body>
<!-- NAV HEADER -->
<div class="d-flex justify-content-between align-items-center px-4 py-2 border-bottom"
     style="background:#fff; position:sticky; top:0; z-index:10">

  <div class="fw-bold" style="font-size:16px;">
    LYTEBRIDGE ACADEMY
  </div>

  <div class="d-flex gap-2">
    <!-- DOWNLOAD PDF -->
<a
  href="/student/results/pdf?session=<%= encodeURIComponent(result.academic_year) %>&term=<%= encodeURIComponent(result.term) %>"
  class="btn btn-success"
>
  Download PDF
</a>


    <!-- BACK -->
  <a href="/student/results/download" class="btn btn-sm btn-outline-secondary">
      ‚Üê Back
    </a>
  </div>
</div>



<div class="container my-5">
  <div class="result-card">

 <div class="row align-items-center mb-2">
  <!-- LOGO -->
  <div class="col-2">
    <img src="/assets/school-logo.png" style="width:70px">
    
  </div>

  <!-- SCHOOL INFO -->
  <div class="col-8 text-center">
    <div class="school-name">LYTEBRIDGE ACADEMY</div>
    <div class="school-sub">
      Academic Excellence & Character<br>
      call: +234 (0) 9136806652 | email: lytebridgeacademy@gmail.com
    </div>
    <div class="report-title">
      REPORT SHEET FOR <%= result.term.toUpperCase() %><br>
      <%= result.academic_year %> SESSION
    </div>
  </div>

  <!-- STUDENT PHOTO -->
  <div class="col-2 text-end">
    <img src="<%= result.student_photo %>"
         style="width:80px;height:95px;border:1px solid #000;object-fit:cover">
  </div>
</div>


   <div class="section-title">STUDENT INFORMATION</div>

<table class="table table-bordered">
  <tr>
    <td><strong>Name:</strong> <%= result.student_name %></td>
    <td><strong>Class:</strong> <%= result.class_name %></td>
    <td><strong>Average:</strong> <%= result.average %></td>
  </tr>
  <tr>
    <td><strong>Academic Session:</strong> <%= result.academic_year %></td>
    <td><strong>Term:</strong> <%= result.term %></td>
    <td><strong>Position:</strong> <%= result.position || '-' %></td>
  </tr>
  <tr>
    <td><strong>Attendance:</strong>
      <% if (result.attendance?.present !== null && result.attendance?.total !== null) { %>
  <%= result.attendance.present %> / <%= result.attendance.total %>
<% } else if (result.attendance?.present !== null) { %>
  <%= result.attendance.present %>
<% } else { %>
  -
<% } %>

    </td>
    <td><strong>Class Highest:</strong> <%= result.class_highest || '-' %></td>
    <td><strong>Class Lowest:</strong> <%= result.class_lowest || '-' %></td>
  </tr>
  <tr>
    <td><strong>Total School Days:</strong> <%= result.attendance?.total || '-' %></td>
    <td colspan="2"><strong>Next Term Begins:</strong> <%= result.next_term_date || '-' %></td>
  </tr>
</table>


   <table class="table table-bordered text-center align-middle">
  <thead>
    <tr>
      <th>Subject</th>
      <th>CA</th>
      <th>Exam</th>
      <th>Total</th>
      <th>Max</th>
      <th>Min</th>
      <th>Class Avg</th>
      <th>Grade</th>
      <th>Remark</th>
    </tr>
  </thead>

  <tbody>
    <% result.subjects.forEach(s => { %>
      <tr>
        <td class="text-start fw-semibold"><%= s.subject %></td>
        <td><%= s.ca %></td>
        <td><%= s.exam %></td>
        <td class="fw-bold"><%= s.total %></td>
        <td><%= s.max_score %></td>
        <td><%= s.min_score %></td>
        <td><%= s.class_average %></td>
        <td class="fw-bold"><%= s.grade %></td>
        <td><%= s.remark %></td>
      </tr>
    <% }) %>
  </tbody>


</table>
<table class="table table-bordered mt-1">
  <tr>
    <td class="text-center fw-bold">
      GRADE RANKING:
      A = 70‚Äì100 | B = 60‚Äì69 | C = 50‚Äì59 | D = 45‚Äì49 | E = 40‚Äì44 | F = 0‚Äì39
    </td>
  </tr>
</table>

<h4 class="mt-4">Behaviour Rating</h4>

<table class="table table-bordered text-center">
  <thead>
    <tr>
      <th>Trait</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <% if (result.behaviour) { %>
      <% Object.entries(result.behaviour).forEach(([k, v]) => { %>
        <tr>
          <td><%= k.replace('_',' ').toUpperCase() %></td>
          <td><%= v ?? '-' %></td>
        </tr>
      <% }) %>
    <% } else { %>
      <tr><td colspan="2">No behaviour record</td></tr>
    <% } %>
  </tbody>
</table>



<table class="table table-bordered mt-3">
  <tr>
    <th style="width:30%">Head of School</th>
    <td style="width:70%">Mrs. A. O. Lawal</td>
  </tr>

  <tr>
    <th>Class Teacher</th>
    <td><%= result.class_teacher %></td>
  </tr>

  <tr>
    <th>Teacher‚Äôs Comment</th>
    <td style="height:50px">
      <%= result.teacher_comment || '______________________________' %>
    </td>
  </tr>
</table>


  </div>
</div>

</body>
</html>
